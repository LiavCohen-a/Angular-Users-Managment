const path = require("path");
const tap = require("tap");
const main = require("./index");

tap.test("fail to run when the module has a parent", t => {
  const fakeModule = { parent: "parent" };
  let test = "";

  main(fakeModule, () => {
    test = "ran";
  });

  setTimeout(() => {
    t.equal(test, "");
    t.end();
  }, 50);
});

tap.test("should run when module has no parent", t => {
  const fakeModule = { parent: null };
  let test = "";

  main(fakeModule, function() {
    test = "ran";
  });

  setTimeout(() => {
    t.equal(test, "ran");
    t.end();
  }, 50);
});
